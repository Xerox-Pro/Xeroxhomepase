<!doctype html>
<html lang="ja">
<head><meta charset="utf-8"/><meta name="viewport"content="width=device-width,initial-scale=1"/><title>Admin — Xerox</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
  <main class="container">
    <section class="card">
      <h2>記事(News)作成</h2>
      <input id="title" placeholder="タイトル" />
      <input id="excerpt" placeholder="抜粋" />
      <textarea id="content" rows="8" placeholder="本文"></textarea>
      <div style="margin-top:8px">
        <button id="add" class="btn">追加</button>
        <button id="download" class="btn outline">Download posts.json</button>
      </div>
      <div id="preview" style="margin-top:12px"></div>
      <p class="muted">生成した posts.json をリポジトリの data/posts.json に上書きして commit & push してね。</p>
    </section>
  </main>

<script>
let posts = [];
async function load(){
  try{
    const r = await fetch('data/posts.json');
    posts = await r.json();
  }catch(e){ posts = [];}
  render();
}
function add(){
  const t = document.getElementById('title').value.trim();
  if(!t) return alert('タイトル入れて');
  const ex = document.getElementById('excerpt').value.trim();
  const c = document.getElementById('content').value.trim();
  const p = { id: 'p'+Date.now().toString(36), title:t, excerpt:ex, content:c, publishedAt:new Date().toISOString() };
  posts.unshift(p);
  render();
}
function render(){ document.getElementById('preview').innerHTML = posts.map(p=>`<div class="card"><strong>${p.title}</strong><div class="muted">${p.publishedAt}</div><p>${p.excerpt}</p></div>`).join(''); }
document.getElementById('add').addEventListener('click', add);
document.getElementById('download').addEventListener('click', ()=>{
  const blob = new Blob([JSON.stringify(posts,null,2)],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'posts.json'; a.click(); URL.revokeObjectURL(url);
});
load();
</script>
</body>
</html>
